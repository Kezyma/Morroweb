<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/scroller/2.3.0/css/scroller.dataTables.min.css" />


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
        <script src="https://cdn.datatables.net/scroller/2.3.0/js/dataTables.scroller.min.js"></script>

        <title>Morroweb</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/morroweb.2.css" />
        <script src="js/morroweb.browser.2.js"></script>
        <script src="js/morroweb.js"></script>
    </head>
    <body>
        <nav id="mw-nav" class="navbar navbar-expand-lg bg-light">
            <div class="container-fluid">
                <a id="mw-title" class="navbar-brand mw-button" href="#">Morroweb</a>
            </div>
        </nav>

        <div id="mw-browser" class="container-fluid" style="max-width:1920px;">
            <div id="mw-browser-card" class="mw-card card">
                <div class="card-header mw-card-header">
                    <select id="mw-browser-select" class="form-control form-control-sm">
                        <option value="home">Select...</option>
                        <option value="gmst">Game Settings</option>
                        <option value="global">Global Variables</option>
                        <option value="skill">Skills</option>
                        <option value="class">Classes</option>
                        <option value="magiceffect">Magic Effects</option>
                        <option value="spell">Spell</option>
                        <option value="race">Race</option>
                    </select>
                </div>
                <div class="mw-card-body card-body">
                    <div id="mw_home_container" role="tabpanel" class="tab-pane mwb-panel p-2">
                        Welcome to the Morroweb browser. Records are directly exported from the GOTY esm files, as well as the Official Plugin esp files.
                    </div>
                    <div id="mw_gmst_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_global_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_skill_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_class_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_magiceffect_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_spell_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_race_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                </div>
            </div>
        </div>

        <script>
            $(document).ready(function () {
                var qs = new URL(location.href).searchParams.get("b");
                if (qs != null && qs != undefined && qs != "") {
                    $("#mw-browser-select").val(qs).change();
                    switchTab(qs)
                }

                $("#mw-browser-select").change(function () {
                    setQueryString($("#mw-browser-select").val());
                    switchTab($("#mw-browser-select").val());
                });
            });

            function setQueryString(val) {
                var query = new URL(location.href.split("?")[0]);
                query.searchParams.set("b", val)
                window.history.pushState({title: "Morroweb", html: window.html, id: val}, null, query.href);
            }

            function switchTab(tab) {
                var c = `mw_${tab}_container`;
                switch (tab) {
                    case "gmst":
                        mw_gmst_browser(c);
                        break;
                    case "global":
                        mw_global_browser(c);
                        break;
                    case "skill":
                        mw_skill_browser(c);
                        break;
                    case "class":
                        mw_class_browser(c);
                        break;
                    case "magiceffect":
                        mw_magicEffect_browser(c);
                        break;
                    case "spell":
                        mw_spell_browser(c);
                        break;
                    case "race":
                        mw_race_browser(c);
                        break;
                    default:
                        mw_showPanel(c);
                        break;
                }
            }

        </script>
    </body>
</html>