<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/scroller/2.3.0/css/scroller.dataTables.min.css" />


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
        <script src="https://cdn.datatables.net/scroller/2.3.0/js/dataTables.scroller.min.js"></script>

        <title>Morroweb</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/morroweb.css" />
        <script src="js/morroweb.browser.js"></script>
    </head>
    <body>
        <nav id="mw-nav" class="navbar navbar-expand-lg bg-light">
            <div class="container-fluid">
                <a id="mw-title" class="navbar-brand mw-button" href="#">Morroweb</a>
            </div>
        </nav>

        <div id="mw-browser" class="container-fluid" style="max-width:1920px;">
            <div id="mw-browser-card" class="mw-card card">
                <div class="card-header mw-card-header">
                    <select id="mw-browser-select" class="form-control form-control-sm" style="text-align: left;">
                        <option value="home">Select...</option>
                        <optgroup label="Settings">
                            <option value="gmst">Game Settings</option>
                            <option value="global">Global Variables</option>
                        </optgroup>
                        <optgroup label="Stats">
                            <option value="birthsign">Birthsigns</option>
                            <option value="class">Classes</option>
                            <option value="skill">Skills</option>
                            <option value="race">Races</option>
                            <option value="faction">Factions</option>
                        </optgroup>
                        <optgroup label="Magic">
                            <option value="magiceffect">Magic Effects</option>
                            <option value="spell">Spells</option>
                        </optgroup>
                        <optgroup label="Items">
                            <option value="alchemy">Alchemy</option>
                            <option value="armour">Armour</option>
                            <option value="apparatus">Apparatus</option>
                            <option value="lockpick">Lockpicks</option>
                            <option value="miscitem">Misc Items</option>
                            <option value="probe">Probes</option>
                            <option value="repairitem">Repair Items</option>
                            <option value="weapon">Weapons</option>
                        </optgroup>
                    </select>
                </div>
                <div class="mw-card-body card-body">
                    <div id="mw_home_container" role="tabpanel" class="tab-pane mwb-panel p-2">
                        Welcome to the Morroweb browser. Records are directly exported from the GOTY esm files, as well as the Official Plugin esp files.
                        <br/>
                        Click 'Select...' to pick the records to view, you can bookmark any list with any filter to share or return to it easily.
                    </div>
                    <div id="mw_gmst_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_global_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_skill_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_class_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_magiceffect_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_spell_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_race_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_faction_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_miscitem_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_lockpick_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_probe_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_repairitem_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_apparatus_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_alchemy_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_birthsign_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_armour_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                    <div id="mw_weapon_container" role="tabpanel" class="tab-pane mwb-panel"></div>
                </div>
            </div>
        </div>

        <script>
            
            // Add an event listener
            document.addEventListener("mw-loaded", function (e) {
                var qs = new URL(location.href).searchParams.get("b");
                if (qs != null && qs != undefined && qs != "") {
                    $("#mw-browser-select").val(qs).change();
                    switchTab(qs)
                }

                $("#mw-browser-select").change(function () {
                    setQueryString($("#mw-browser-select").val());
                    switchTab($("#mw-browser-select").val());
                });
            });

            function setQueryString(val) {
                var query = new URL(location.href.split("?")[0]);
                query.searchParams.set("b", val)
                window.history.pushState({title: "Morroweb", html: window.html, id: val}, null, query.href);
            }

            function switchTab(tab) {
                var c = `mw_${tab}_container`;
                switch (tab) {
                    case "gmst":
                        mw_gmst_browser(c);
                        break;
                    case "global":
                        mw_global_browser(c);
                        break;
                    case "skill":
                        mw_skill_browser(c);
                        break;
                    case "class":
                        mw_class_browser(c);
                        break;
                    case "magiceffect":
                        mw_magicEffect_browser(c);
                        break;
                    case "spell":
                        mw_spell_browser(c);
                        break;
                    case "race":
                        mw_race_browser(c);
                        break;
                    case "faction":
                        mw_faction_browser(c);
                        break;
                    case "miscitem":
                        mw_miscItem_browser(c);
                        break;
                    case "lockpick":
                        mw_lockpick_browser(c);
                        break;
                    case "apparatus":
                        mw_apparatus_browser(c);
                        break;
                    case "repairitem":
                        mw_repairItem_browser(c);
                        break;
                    case "probe":
                        mw_probe_browser(c);
                        break;
                    case "alchemy":
                        mw_alchemy_browser(c);
                        break;
                    case "birthsign":
                        mw_birthsign_browser(c);
                        break;
                    case "armour":
                        mw_armour_browser(c);
                        break;
                    case "weapon":
                        mw_weapon_browser(c);
                        break;
                    default:
                        mw_showPanel(c);
                        break;
                }
            }

        </script>
    </body>
</html>